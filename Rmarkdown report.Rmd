---
title: "Data_report"
author: "Jilin He"
date: '2022-07-06'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
Cab_Data <- as_tibble(read.csv("Cab_Data.csv", header = TRUE))
City <- as_tibble(read.csv("City.csv", header = TRUE))
Customer_ID <- as_tibble(read.csv("Customer_ID.csv", header = TRUE))
Transaction_ID <- as_tibble(read.csv(
  "Transaction_ID.csv",
  header = TRUE)
)
table(Cab_Data$Company)
Merged_Data <- left_join(
  Cab_Data,
  Transaction_ID, 
  by = "Transaction.ID")
Merged_Data <- left_join(
  Merged_Data,
  Customer_ID,
  by = "Customer.ID"
)
Merged_Data <- left_join(
  Merged_Data,
  City,
  by = "City"
)
Merged_Data <- mutate(
  Merged_Data,
  price_per_km = round(
    Price.Charged/KM.Travelled,
    digits = 2
    )
)
```

There are `r nrow(Merged_Data)` available transaction records. We can see that `r nrow(filter(Merged_Data, Company == "Pink Cab"))` transactions that belong to Pink Cab, and `r nrow(filter(Merged_Data, Company == "Yellow Cab"))` transactions that belong to Yellow Cab.

```{r Company_category, echo=FALSE}
ggplot(data = Merged_Data)+
  geom_bar(aes(Company))
```

Below is the distribution of cities.
```{r City_distribution, echo=FALSE}
ggplot(data = Merged_Data)+
  geom_bar(aes(City,fill=Company), 
           position = "dodge")+
  theme(axis.text.x = element_text(angle = 90, size = 5))
```

Below is price per km each city for each company.

```{r price_per_km, echo=FALSE}
Price_per_km <- group_by(
  Merged_Data,
  City,
  Company
)
Price_per_km <- summarise(
  Price_per_km,
  price_average = mean(price_per_km)
)
ungroup(Price_per_km)
ggplot(data = Price_per_km)+
  geom_bar(
    mapping = aes(
      x = City,
      y = price_average, 
      fill = Company
    ),
    stat = "identity",
    position = "dodge"
  )+
  theme(axis.text.x = element_text(angle = 90, size = 5))
```

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
